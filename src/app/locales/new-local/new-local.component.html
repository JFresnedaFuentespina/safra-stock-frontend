<app-navbar></app-navbar>

<div class="container mt-4" style="max-width: 600px;">
    <h3>Crear nuevo local</h3>

    <form (ngSubmit)="onSubmit()">
        <!-- Nombre -->
        <div class="mb-3">
            <label for="localName" class="form-label">Nombre del local</label>
            <input type="text" id="localName" class="form-control" [(ngModel)]="name" name="localName" required />
        </div>

        <!-- Stock mínimo -->
        <div class="mb-3">
            <label for="stockMin" class="form-label">Stock mínimo por producto</label>
            <input type="number" id="stockMin" class="form-control" [(ngModel)]="stockMinPerProduct" name="stockMin"
                min="1" required />
        </div>

        <!-- Tipos de local (múltiple con checkboxes) -->
        <div class="mb-3">
            <label class="form-label">Tipos de local</label>
            <div class="d-flex flex-column">
                <div *ngFor="let type of localTypes" class="form-check">
                    <input class="form-check-input" type="checkbox" [id]="type" [value]="type"
                        (change)="toggleTypeSelection(type, $event)" [checked]="selectedTypes.includes(type)" />
                    <label class="form-check-label" [for]="type">{{ type }}</label>
                </div>
            </div>
        </div>



        <!-- Buscar trabajadores -->
        <div class="mb-3">
            <label class="form-label">Buscar trabajadores</label>
            <input type="text" class="form-control mb-2" [(ngModel)]="searchTerm" name="search"
                placeholder="Buscar por nombre o email" />
            <ul class="list-group" style="max-height: 200px; overflow-y: auto;">
                <li class="list-group-item d-flex justify-content-between align-items-center"
                    *ngFor="let user of users | filter: searchTerm" (click)="toggleUserSelection(user)"
                    [class.active]="isSelected(user)">
                    {{ user.name }} ({{ user.email }})
                    <span *ngIf="isSelected(user)" class="badge bg-success">✓</span>
                </li>
            </ul>
        </div>

        <!-- Lista de trabajadores seleccionados -->
        <div class="mb-3">
            <label class="form-label">Trabajadores seleccionados:</label>
            <div *ngIf="selectedUsers.length === 0" class="text-muted">Ninguno seleccionado</div>
            <ul class="list-group" *ngIf="selectedUsers.length > 0">
                <li class="list-group-item" *ngFor="let u of selectedUsers">
                    {{ u.name }} ({{ u.email }})
                </li>
            </ul>
        </div>

        <!-- Botón -->
        <button type="submit" class="btn btn-primary w-100">Crear local</button>
    </form>
</div>