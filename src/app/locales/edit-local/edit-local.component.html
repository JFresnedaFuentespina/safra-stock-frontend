<app-navbar></app-navbar>

<div class="container mt-4" style="max-width: 600px;">
    <h3>{{ id ? 'Editar local' : 'Crear nuevo local' }}</h3>

    <form (ngSubmit)="onSubmit()">
        <!-- Nombre del local -->
        <div class="mb-3">
            <label for="localName" class="form-label">Nombre del local</label>
            <input type="text" id="localName" class="form-control" [(ngModel)]="name" name="localName" required />
        </div>

        <!-- Stock mínimo por producto -->
        <div class="mb-3">
            <label for="stockMin" class="form-label">Stock mínimo por producto</label>
            <input type="number" id="stockMin" class="form-control" [(ngModel)]="stockMinPerProduct" name="stockMin"
                min="1" required />
        </div>

        <!-- Buscar trabajadores -->
        <div class="mb-3">
            <label class="form-label">Buscar trabajadores</label>
            <input type="text" class="form-control mb-2" [(ngModel)]="searchTerm" name="search"
                placeholder="Buscar por nombre o email" />
            <ul class="list-group" style="max-height: 200px; overflow-y: auto;">
                <li class="list-group-item d-flex justify-content-between align-items-center"
                    *ngFor="let user of filteredUsers" (click)="toggleUserSelection(user)"
                    [class.active]="isSelected(user)">
                    {{ user.name }} ({{ user.email }})
                    <span *ngIf="isSelected(user)" class="badge bg-success">✓</span>
                </li>
            </ul>
        </div>

        <!-- Trabajadores seleccionados -->
        <div class="mb-3">
            <label class="form-label">Trabajadores seleccionados:</label>
            <div *ngIf="selectedUsers.length === 0" class="text-muted">Ninguno seleccionado</div>
            <ul class="list-group" *ngIf="selectedUsers.length > 0">
                <li class="list-group-item" *ngFor="let u of selectedUsers">
                    {{ u.name }} ({{ u.email }})
                </li>
            </ul>
        </div>

        <!-- Botón enviar -->
        <button type="submit" class="btn btn-primary w-100">
            {{ id ? 'Guardar cambios' : 'Crear local' }}
        </button>
    </form>
</div>