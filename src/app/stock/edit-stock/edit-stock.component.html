<app-navbar></app-navbar>

<div class="container mt-4">
    <h2 class="my-4 text-center">Editar Stock</h2>

    <!-- Mensajes -->
    <div *ngIf="loading" class="alert alert-info">
        Cargando stock…
    </div>

    <div *ngIf="error" class="alert alert-danger">
        {{ error }}
    </div>

    <!-- Información del stock -->
    <div *ngIf="!loading && !error" class="mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title mb-3">Información del Stock</h5>
                <p class="mb-1"><strong>Local:</strong> {{ localName }}</p>
                <p class="mb-0"><strong>Fecha:</strong> {{ stockDate }}</p>
            </div>
        </div>
    </div>

    <!-- Formulario -->
    <form *ngIf="!loading && !error" [formGroup]="form" (ngSubmit)="onSubmit()">

        <div formArrayName="products">

            <div *ngFor="let product of productsArray.controls; let i = index"
                 [formGroupName]="i"
                 class="card mb-4 shadow-sm">

                <div class="card-body">

                    <h5 class="card-title">
                        {{ product.get('productName')?.value }}
                    </h5>

                    <div class="row g-2 align-items-center">

                        <!-- Cantidad -->
                        <div class="col-12 col-md-6">
                            <label class="form-label">Cantidad</label>
                            <input type="number"
                                   formControlName="stock"
                                   class="form-control"
                                   min="0"
                                   required>
                        </div>

                        <!-- Stock mínimo (opcional visual) -->
                        <!-- <div class="col-12 col-md-6 d-flex align-items-end">
                            <div *ngIf="product.get('stock')?.value < stockMin"
                                 class="alert alert-warning w-100 mb-0 py-2">
                                Por debajo del stock mínimo
                            </div>
                        </div> -->

                    </div>

                </div>
            </div>

        </div>

        <button type="submit"
                class="btn btn-success w-100 mt-3 mb-4">
            Guardar Cambios
        </button>

    </form>
</div>
